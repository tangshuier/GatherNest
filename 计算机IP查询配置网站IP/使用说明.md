# 自动IP配置工具使用说明

## 功能介绍

本工具可以自动检测您计算机的局域网IP地址，并更新Flask网站的配置，使网站始终使用正确的IP地址运行。主要解决了以下问题：

- 当计算机IP地址因网络环境变化而改变时，无需手动修改配置
- 自动记录IP地址变更历史，便于排查问题
- 提供简单的一键操作方式，方便非技术人员使用

## 文件结构

```
计算机IP查询配置网站IP/
├── update_server_ip.py   # 主要Python脚本，实现IP检测和配置更新
├── 自动配置网站IP地址.bat # Windows批处理文件，方便直接运行
└── ip_address_log.txt    # IP地址变更日志（自动生成）
```

## 使用方法

### 方法一：双击批处理文件（推荐）

1. 找到并双击 `自动配置网站IP地址.bat` 文件
2. 等待脚本执行完成
3. 根据提示手动重启Flask服务器

### 方法二：直接运行Python脚本

1. 打开命令提示符（CMD）或PowerShell
2. 导航到脚本所在目录：`cd f:\资料整理网站\计算机IP查询配置网站IP`
3. 运行命令：`python update_server_ip.py`
4. 等待脚本执行完成
5. 重启Flask服务器

## 工作原理

1. **IP地址检测**：脚本会尝试多种方法获取计算机的局域网IP地址：
   - 通过socket连接外部服务器确定
   - 在Windows系统上解析ipconfig命令输出
   - 获取所有网络接口的IP地址信息

2. **配置更新**：脚本会自动修改 `app.py` 文件中的 `FIXED_HOST` 变量为检测到的IP地址

3. **日志记录**：每次运行都会将检测到的IP地址和时间戳记录到 `ip_address_log.txt` 文件中

## 注意事项

1. **权限要求**：确保您有修改 `app.py` 文件的权限

2. **Python环境**：使用前请确保已安装Python并添加到系统路径中

3. **防火墙设置**：如果配置后其他计算机无法访问网站，请检查防火墙设置是否允许5001端口的访问

4. **手动重启**：脚本执行完成后需要手动重启Flask服务器以应用新的IP配置

5. **网络环境**：如果您的计算机有多个网络接口（如同时连接有线和无线网络），脚本会选择其中一个IP地址，可能需要手动调整

## 故障排除

1. **找不到Python**：请安装Python并确保已添加到系统环境变量中

2. **无法修改app.py**：请以管理员身份运行脚本

3. **检测到错误的IP地址**：可以手动编辑 `app.py` 文件中的 `FIXED_HOST` 变量，设置为正确的IP地址

4. **其他计算机无法访问**：检查网络连接、防火墙设置和IP地址是否正确

## 常见问题

**Q: 为什么每次启动都需要运行这个脚本？**
**A:** 如果您的计算机IP地址是动态分配的，每次重启或网络重连后可能会改变。运行此脚本可以确保网站使用最新的IP地址。

**Q: 如何让计算机使用固定的IP地址？**
**A:** 您可以在路由器或网络设置中为计算机分配静态IP地址，这样就不需要频繁更新配置了。

**Q: 日志文件会无限增长吗？**
**A:** 是的，日志文件会记录每次运行的IP地址信息。您可以定期清理或归档日志文件。